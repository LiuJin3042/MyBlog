# IP寻址

## IPv4网络地址

### IPv4地址结构

* 包括网络部分和主机部分, 标识网络和主机
* 子网掩码: IP地址和子网掩码做与运算, 如果结果相同, 则表示为在同一个子网下.
* 非标准子网掩码: 用1的个数标识子网掩码: /27标识子网掩码前27位是1, 后面5位是0. 用IP地址+斜杠标识: `192.168.0.250/27`, 长度越大, 子网网段内地址越少. 
* 主机位全为1的地址是广播地址, 全为0是网段地址

### IPv4单播, 组播, 广播

* 特殊用途的地址段
  * 组播地址
    * 224.0.0.0-239.255.255.255: 用于组播
    * 224.0.0.0-224.0.0.255: 用于本地组播
    * 224.0.0.9: 用于RIP通讯
  * 私有地址
    * 10.0.0.0/8
    * 172.16.0.0/12, 即172.16.0.0-172.31.255.255
    * 192.168.0.0/16
  * 特殊地址
    * 127.0.0.0/8, 用于测试IPv4协议栈
    * 169.254.0.0/16, 如果主机ip地址为此, 说明ip地址配置错误/没有dhcp服务器. 这个地址仅能用于内网通讯

* 有类编制, 目前已不采用, 用统一组织分配IP地址. 目前IPv4地址已耗尽
  * A类: 0.0.0.0/8 – 127.0.0.0/8
  * B类128.0.0.0 /16 – 191.255.0.0 /16
  * C类192.0.0.0 /24 – 223.255.255.0 /24

## IPv6网络地址

### IPv4和IPv6共存

* 双堆栈: 同时有IPv4和v6协议栈
* 隧道: 让IPv6协议通过IPv4网络
* 转换: IPv6地址转化为IPv4

### IPv6编址

* 128位2进制编码, 用8组*4位16进制编码, 用冒号分隔.
* 简写方式
  * 每个段由4个16进制构成, 可以忽略开头的0, 如果一个段全为0, 至少写1个0. 
  * 可以使用**一次**双冒号来省略全是0的段落. 
* 前64位是前缀(网络地址), 后64位是接口id(主机地址)

### IPv6地址类型

* 单播, 组播, 任博(相当于广播)

### IPv6单播地址

* 全局单播(GUA): 公共地址, 2000-3FFF, 第一位是2或3. 全局路由前缀由48位, 后16位为子网id
* 本地链路: 子网 FE80::/10  
* 环回: ::1/128

### 动态配置

SLAAC, 无状态地址自动配置